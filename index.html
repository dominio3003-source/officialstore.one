<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Editor Presell â€” Max Boost (Editable)</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    :root{
      --accent:#f59e0b;
      --accent-dark:#fbbf24;
      --primary:#0a2342;
      --muted:#7a7a7a;
      --card-bg:#fff;
      --bg:#f8fafc;
      --success:#10b981;
      --error:#ef4444;
    }
    *{box-sizing:border-box}
    body{font-family:'Poppins',sans-serif;margin:0;background:var(--bg);color:#1e293b}
    .app {
      display:grid;
      grid-template-columns:360px 1fr;
      min-height:100vh;
    }
    /* Sidebar editor */
    .editor {
      background:#fff;
      border-right:1px solid #e6eef8;
      padding:18px;
      overflow:auto;
      position:relative;
    }
    .editor h2{font-size:18px;margin:8px 0 12px}
    .field{margin-bottom:12px}
    .field label{display:block;font-size:13px;margin-bottom:6px;color:var(--muted)}
    .field input[type="text"], .field input[type="url"], .field textarea, .field select {
      width:100%; padding:10px;border-radius:8px;border:1px solid #e2e8f0;font-size:14px;
      transition:border-color 0.2s;
    }
    .field input:focus, .field textarea:focus, .field select:focus {
      outline:none;
      border-color:var(--accent);
      box-shadow:0 0 0 3px rgba(245,158,11,0.1);
    }
    .small{font-size:12px;color:var(--muted)}
    .btn {display:inline-block;padding:10px 14px;border-radius:8px;text-decoration:none;border:none;cursor:pointer;font-weight:600;transition:all 0.2s}
    .btn-save{background:var(--primary);color:#fff;margin-right:8px}
    .btn-save:hover{background:#0a1e36;transform:translateY(-2px)}
    .btn-export{background:var(--accent);color:#072033}
    .btn-export:hover{background:#e6950a;transform:translateY(-2px)}
    .btn-danger{background:#ef4444;color:#fff}
    .btn-danger:hover{background:#dc2626;transform:translateY(-2px)}
    .btn-success{background:var(--success);color:#fff}
    .btn-success:hover{background:#0da271;transform:translateY(-2px)}
    .row{display:flex;gap:8px}
    .muted{color:var(--muted);font-size:13px}
    .section-divider{height:1px;background:#eef5ff;margin:14px 0;border-radius:2px}
    .list{background:#fbfdff;padding:10px;border-radius:8px;border:1px dashed #e6eef8;max-height:200px;overflow-y:auto}
    .list-item{display:flex;gap:8px;align-items:center;padding:6px 0;border-bottom:1px solid #f3f7fb}
    .list-item:last-child{border-bottom:0}
    .icon-btn{background:#f1f7ff;border-radius:6px;padding:6px;cursor:pointer;border:none;transition:background 0.2s}
    .icon-btn:hover{background:#e1efff}
    .status-message{position:fixed;bottom:20px;right:20px;padding:12px 16px;border-radius:8px;color:white;font-weight:600;z-index:100;opacity:0;transform:translateY(10px);transition:all 0.3s}
    .status-message.show{opacity:1;transform:translateY(0)}
    .status-success{background:var(--success)}
    .status-error{background:var(--error)}
    /* Preview area */
    .preview {
      overflow:auto;
      min-height:100vh;
      background:linear-gradient(180deg,#ffffff 0%, #fbfdff 100%);
    }
    /* Use the user's design adapted from provided code */
    header.preview-header{
      background:linear-gradient(135deg,var(--primary),#1e3a8a);
      color:#fff;
      text-align:center;
      padding:40px 20px;
      border-bottom:6px solid var(--accent-dark);
    }
    header.preview-header h1{font-size:32px;margin:4px 0}
    header.preview-header p{margin:6px 0;font-size:15px}
    .hero {
      height:60vh;
      position:relative;
      display:flex;
      align-items:center;
      justify-content:center;
      background-size: cover;
      background-position: center;
    }
    .video-container {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      overflow: hidden;
    }
    .video-container iframe {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
    .hero::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(10, 35, 66, 0.3);
      z-index: 1;
    }
    .hero > * {
      position: relative;
      z-index: 2;
    }
    .cta-large{
      background:linear-gradient(90deg,var(--accent-dark),var(--accent));
      color:#072033;
      font-weight:700;
      padding:14px 28px;
      border-radius:50px;
      text-decoration:none;
      display:inline-block;
      box-shadow:0 8px 24px rgba(251,191,36,0.25);
      transform:translateY(0);
      transition:all 0.3s;
      font-size: 18px;
      text-align: center;
      line-height: 1.4;
    }
    .cta-large:hover{
      transform:translateY(-3px);
      box-shadow:0 12px 28px rgba(251,191,36,0.35);
    }
    .content{max-width:1100px;margin:32px auto;padding:0 20px}
    .cards{display:grid;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));gap:18px}
    .card{background:var(--card-bg);padding:18px;border-radius:12px;border:1px solid #eef5ff;box-shadow:0 6px 18px rgba(2,6,23,0.03);transition:transform 0.2s}
    .card:hover{transform:translateY(-5px)}
    .ingredients .card strong{display:block;margin-bottom:6px}
    .reviews-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));gap:18px}
    .review-card{background:#fff;border-radius:12px;padding:16px;box-shadow:0 8px 20px rgba(2,6,23,0.04);transition:transform 0.2s}
    .review-card:hover{transform:translateY(-5px)}
    .review-card .meta{display:flex;gap:12px;align-items:center}
    .avatar{width:56px;height:56px;border-radius:50%;object-fit:cover;border:2px solid #f2f2f2}
    footer{background:var(--primary);color:#fff;padding:24px;text-align:center;border-top:4px solid var(--accent)}
    /* responsive editor collapse on small screens */
    @media (max-width:900px){
      .app{grid-template-columns:1fr}
      .editor{position:fixed;z-index:40;left:0;top:0;bottom:0;width:320px;transform:translateX(-380px);transition:transform .25s}
      .editor.open{transform:translateX(0);box-shadow:0 30px 60px rgba(2,6,23,0.2)}
      .toggle-editor{position:fixed;right:16px;bottom:16px;z-index:50;padding:12px 14px;border-radius:12px;background:var(--accent);color:#072033;border:none;font-weight:600;box-shadow:0 4px 12px rgba(0,0,0,0.15)}
    }
    @media (max-width: 768px) {
      .hero {
        height: auto;
        min-height: 80vh;
        flex-direction: column;
        padding: 20px 0;
      }
      
      .video-container {
        position: relative;
        height: 50vh;
        width: 100%;
        flex-shrink: 0;
      }
      
      .hero::before {
        display: none;
      }
      
      .video-container::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(10, 35, 66, 0.3);
        z-index: 1;
      }
      
      .cta-large {
        margin-top: 20px;
        font-size: 16px;
        padding: 12px 24px;
        width: 90%;
        max-width: 300px;
      }
    }
  </style>
</head>
<body>
  <div class="app">
    <!-- EDITOR SIDEBAR -->
    <aside class="editor" id="editor">
      <h2>Editor do Presell</h2>

      <div class="field">
        <label>Nome do produto</label>
        <input type="text" id="productName" value="Max Boost">
        <div class="small">Este nome atualiza tÃ­tulos, CTA e highlights.</div>
      </div>

      <div class="field">
        <label>TÃ­tulo curto / SubtÃ­tulo</label>
        <input type="text" id="subtitle" value="Unlock Your Ultimate Vitality">
      </div>

      <div class="field">
        <label>Link do botÃ£o de compra (href)</label>
        <input type="url" id="buyLink" placeholder="https://seusite.com/checkout" value="#buy">
      </div>

      <div class="field">
        <label>Tipo de Fundo</label>
        <select id="backgroundType">
          <option value="image">Imagem</option>
          <option value="video">VÃ­deo do YouTube</option>
        </select>
      </div>

      <div class="field image-background">
        <label>Imagem de fundo (desktop) â€” URL</label>
        <input type="url" id="bgDesktop" placeholder="URL da imagem desktop" value="https://images.unsplash.com/photo-1579546929662-711aa81148cf?ixlib=rb-1.2.1&auto=format&fit=crop&w=1950&q=80">
        <div class="small">Use imagens de alta qualidade para melhor visualizaÃ§Ã£o.</div>
      </div>

      <div class="field image-background">
        <label>Imagem de fundo (mobile) â€” URL</label>
        <input type="url" id="bgMobile" placeholder="URL da imagem mobile" value="https://images.unsplash.com/photo-1579546929662-711aa81148cf?ixlib=rb-1.2.1&auto=format&fit=crop&w=750&q=80">
        <div class="small">Imagem otimizada para visualizaÃ§Ã£o em dispositivos mÃ³veis.</div>
      </div>

      <div class="field video-background" style="display:none">
        <label>ID do VÃ­deo do YouTube</label>
        <input type="text" id="youtubeVideoId" placeholder="Ex: dQw4w9WgXcQ" value="dQw4w9WgXcQ">
        <div class="small">O ID do vÃ­deo do YouTube (encontrado na URL do vÃ­deo).</div>
      </div>

      <div class="section-divider"></div>

      <h2>BenefÃ­cios (cards)</h2>
      <div id="benefitsList" class="list"></div>
      <div class="row" style="margin-top:8px">
        <input id="newBenefit" type="text" placeholder="Adicionar benefÃ­cio..." style="flex:1;padding:8px;border-radius:8px;border:1px solid #e6eef8">
        <button class="btn btn-success" id="addBenefit">âž•</button>
      </div>

      <div class="section-divider"></div>

      <h2>Ingredientes</h2>
      <div id="ingredientsList" class="list"></div>
      <div class="row" style="margin-top:8px">
        <input id="newIngredient" type="text" placeholder="Adicionar ingrediente..." style="flex:1;padding:8px;border-radius:8px;border:1px solid #e6eef8">
        <button class="btn btn-success" id="addIngredient">âž•</button>
      </div>

      <div class="section-divider"></div>

      <h2>Reviews</h2>
      <div id="reviewsList" class="list"></div>
      <div style="margin-top:8px">
        <button class="btn btn-success" id="addReview">Adicionar review</button>
      </div>

      <div class="section-divider"></div>

      <h2>RodapÃ© & Links</h2>
      <div class="field">
        <label>Privacy Policy (URL)</label>
        <input type="url" id="privacyUrl" value="privacy/privacy.html">
      </div>
      <div class="field">
        <label>Terms (URL)</label>
        <input type="url" id="termsUrl" value="terms.html">
      </div>

      <div class="section-divider"></div>

      <div style="display:flex;gap:8px;flex-wrap:wrap">
        <button class="btn btn-save" id="saveBtn">Salvar (local)</button>
        <button class="btn btn-export" id="exportBtn">Exportar HTML</button>
        <button class="btn btn-danger" id="resetBtn">Resetar para padrÃ£o</button>
      </div>

      <p style="margin-top:14px;font-size:12px;color:var(--muted)">
        Dica: use URLs de imagens pÃºblicas ou o ID do vÃ­deo do YouTube.
      </p>
    </aside>

    <!-- PREVIEW -->
    <main class="preview" id="previewArea">
      <!-- header -->
      <header class="preview-header">
        <h1 id="previewTitle">Max Boost ðŸ’ª</h1>
        <p id="previewSubtitle">Unlock Your Ultimate Vitality</p>
      </header>

      <!-- hero with background and button -->
      <div class="hero" id="hero">
        <div class="video-container" id="videoContainer"></div>
        <a id="ctaBtn" class="cta-large" href="#buy">
          <span style="display:block; font-size: 14px; margin-bottom: 5px;">I WANT MY</span>
          <span style="display:block; font-size: 22px; font-weight: 800;">MAX BOOST NOW</span>
        </a>
      </div>

      <div class="content">
        <section>
          <h2>ðŸŒ¿ Rediscover Your Natural Vitality</h2>
          <p><span id="highlightName" style="font-weight:700;color:var(--accent)">Max Boost</span> is an all-natural formula designed to support her and enhance sexual drive. Made in the USA from a proprietary powerful natural ingredients, it promotes healthy blood flow supports overall vitality, improves energy, sleep quality, skin and inflammatory response.</p>
        </section>

        <section>
          <h2>ðŸ’¥ Exclusive Benefits</h2>
          <div class="cards" id="benefitsCards"></div>
        </section>

        <section class="ingredients" style="margin-top:18px">
          <h2>ðŸŒ± Selected Natural Ingredients</h2>
          <div class="cards" id="ingredientsCards"></div>
        </section>

        <div class="cta" style="text-align:center;margin:36px 0">
          <a id="ctaBottom" class="cta-large" href="#buy">
            <span style="display:block; font-size: 14px; margin-bottom: 5px;">I WANT MY</span>
            <span style="display:block; font-size: 22px; font-weight: 800;">MAX BOOST NOW</span>
          </a>
        </div>

        <section class="testimonials">
          <h2 style="margin-bottom:16px">What customers are saying</h2>
          <div class="reviews-grid" id="reviewsGrid"></div>
          <p style="font-size:12px;color:var(--muted);margin-top:8px">*Results may vary from person to person.</p>
        </section>

        <footer style="margin-top:40px">
          <p>Â© <span id="footerYear"></span> <span id="footerProduct">Max Boost</span> â€” <a id="privacyLink" href="privacy/privacy.html" style="color:#dbeafe;text-decoration:underline">Privacy Policy</a> | <a id="termsLink" href="terms.html" style="color:#dbeafe;text-decoration:underline">Terms</a></p>
        </footer>
      </div>
    </main>
  </div>

  <!-- Status messages -->
  <div id="statusMessage" class="status-message"></div>

  <!-- toggle editor for small screens -->
  <button class="toggle-editor" id="toggleEditor" style="display:none">Editor</button>

  <script>
    /* ---------- App state & defaults (derived from user's provided page) ---------- */
    const DEFAULT = {
      productName: "Max Boost",
      subtitle: "Unlock Your Ultimate Vitality",
      buyLink: "#buy",
      backgroundType: "image",
      bgDesktop: "https://images.unsplash.com/photo-1579546929662-711aa81148cf?ixlib=rb-1.2.1&auto=format&fit=crop&w=1950&q=80",
      bgMobile: "https://images.unsplash.com/photo-1579546929662-711aa81148cf?ixlib=rb-1.2.1&auto=format&fit=crop&w=750&q=80",
      youtubeVideoId: "dQw4w9WgXcQ",
      benefits: [
        "âœ… Promotes healthy blood flow",
        "âœ… Supports overall vitality",
        "âœ… Improves energy and sleep quality",
        "âœ… Enhances skin and inflammatory response",
        "âœ… 100% natural formula"
      ],
      ingredients: [
        "Powerful Natural Blend: Proprietary formula with natural ingredients",
        "Blood Flow Support: Promotes healthy circulation",
        "Vitality Boost: Enhances energy and overall well-being",
        "Sleep Quality: Improves rest and recovery"
      ],
      reviews: [
        {name:"Robert M.", text:"I was feeling tired all the time... After using Max Boost for a month, my energy levels are through the roof!", rating:5, date:"2025-06-18", avatar:"https://i.pravatar.cc/150?img=12"},
        {name:"William R.", text:"I've been using Max Boost for a few weeks now, and I'm honestly amazed at how much it has improved my vitality and energy.", rating:5, date:"2025-07-02", avatar:"https://i.pravatar.cc/150?img=15"},
        {name:"David P.", text:"My life had changed. My energy returned. I felt younger and more vibrant than ever.", rating:5, date:"2025-05-27", avatar:"https://i.pravatar.cc/150?img=5"}
      ],
      privacyUrl: "privacy/privacy.html",
      termsUrl: "terms.html"
    };

    // load saved or default
    const STORAGE_KEY = "presell_editor_state_v1";
    function loadState(){ try{
      const raw = localStorage.getItem(STORAGE_KEY);
      if(!raw) return {...DEFAULT};
      return {...DEFAULT, ...JSON.parse(raw)};
    } catch(e){ console.warn(e); return {...DEFAULT}; } }

    function saveState(state){
      localStorage.setItem(STORAGE_KEY, JSON.stringify(state));
    }

    let state = loadState();

    /* ---------- helpers to sync UI <-> state ---------- */
    // Editor inputs
    const productNameInput = document.getElementById("productName");
    const subtitleInput = document.getElementById("subtitle");
    const buyLinkInput = document.getElementById("buyLink");
    const backgroundTypeInput = document.getElementById("backgroundType");
    const bgDesktopInput = document.getElementById("bgDesktop");
    const bgMobileInput = document.getElementById("bgMobile");
    const youtubeVideoIdInput = document.getElementById("youtubeVideoId");
    const benefitsList = document.getElementById("benefitsList");
    const ingredientsList = document.getElementById("ingredientsList");
    const reviewsList = document.getElementById("reviewsList");
    const benefitsCards = document.getElementById("benefitsCards");
    const ingredientsCards = document.getElementById("ingredientsCards");
    const reviewsGrid = document.getElementById("reviewsGrid");
    const previewTitle = document.getElementById("previewTitle");
    const previewSubtitle = document.getElementById("previewSubtitle");
    const highlightName = document.getElementById("highlightName");
    const ctaBtn = document.getElementById("ctaBtn");
    const ctaBottom = document.getElementById("ctaBottom");
    const ctaProduct = document.getElementById("ctaProduct");
    const hero = document.getElementById("hero");
    const videoContainer = document.getElementById("videoContainer");
    const footerYear = document.getElementById("footerYear");
    const footerProduct = document.getElementById("footerProduct");
    const privacyLink = document.getElementById("privacyLink");
    const termsLink = document.getElementById("termsLink");
    const addBenefitBtn = document.getElementById("addBenefit");
    const newBenefitInput = document.getElementById("newBenefit");
    const addIngredientBtn = document.getElementById("addIngredient");
    const newIngredientInput = document.getElementById("newIngredient");
    const addReviewBtn = document.getElementById("addReview");
    const saveBtn = document.getElementById("saveBtn");
    const exportBtn = document.getElementById("exportBtn");
    const resetBtn = document.getElementById("resetBtn");
    const privacyUrlInput = document.getElementById("privacyUrl");
    const termsUrlInput = document.getElementById("termsUrl");
    const statusMessage = document.getElementById("statusMessage");

    // Toggle background type fields
    function toggleBackgroundFields() {
      const backgroundType = backgroundTypeInput.value;
      const imageFields = document.querySelectorAll('.image-background');
      const videoFields = document.querySelectorAll('.video-background');
      
      if (backgroundType === 'image') {
        imageFields.forEach(field => field.style.display = 'block');
        videoFields.forEach(field => field.style.display = 'none');
      } else {
        imageFields.forEach(field => field.style.display = 'none');
        videoFields.forEach(field => field.style.display = 'block');
      }
    }

    /* init inputs */
    function populateEditorFromState(){
      productNameInput.value = state.productName || DEFAULT.productName;
      subtitleInput.value = state.subtitle || DEFAULT.subtitle;
      buyLinkInput.value = state.buyLink || DEFAULT.buyLink;
      backgroundTypeInput.value = state.backgroundType || DEFAULT.backgroundType;
      bgDesktopInput.value = state.bgDesktop || DEFAULT.bgDesktop;
      bgMobileInput.value = state.bgMobile || DEFAULT.bgMobile;
      youtubeVideoIdInput.value = state.youtubeVideoId || DEFAULT.youtubeVideoId;
      privacyUrlInput.value = state.privacyUrl || DEFAULT.privacyUrl;
      termsUrlInput.value = state.termsUrl || DEFAULT.termsUrl;
      
      toggleBackgroundFields();
    }

    function showStatus(message, isSuccess = true) {
      statusMessage.textContent = message;
      statusMessage.className = `status-message ${isSuccess ? 'status-success' : 'status-error'} show`;
      
      setTimeout(() => {
        statusMessage.classList.remove('show');
      }, 3000);
    }

    function renderBenefits(){
      benefitsList.innerHTML = "";
      benefitsCards.innerHTML = "";
      state.benefits.forEach((b, i) => {
        // editor list item
        const li = document.createElement("div");
        li.className = "list-item";
        li.innerHTML = `
          <input type="text" data-index="${i}" class="benefit-input" style="flex:1;border:0;background:transparent" value="${escapeHtml(b)}">
          <button class="icon-btn" data-action="del-benefit" data-index="${i}">âœ–</button>
        `;
        benefitsList.appendChild(li);

        // preview card
        const card = document.createElement("div");
        card.className = "card";
        card.textContent = b;
        benefitsCards.appendChild(card);
      });
      // attach events
      document.querySelectorAll(".benefit-input").forEach(inp=>{
        inp.addEventListener("input", e=>{
          const idx = +e.target.dataset.index;
          state.benefits[idx] = e.target.value;
          renderBenefits();
        });
      });
      document.querySelectorAll("[data-action='del-benefit']").forEach(btn=>{
        btn.addEventListener("click", e=>{
          const idx = +e.target.dataset.index;
          state.benefits.splice(idx,1);
          renderBenefits();
        });
      });
    }

    function renderIngredients(){
      ingredientsList.innerHTML = "";
      ingredientsCards.innerHTML = "";
      state.ingredients.forEach((ing, i)=>{
        const li = document.createElement("div");
        li.className = "list-item";
        li.innerHTML = `
          <input type="text" data-index="${i}" class="ingredient-input" style="flex:1;border:0;background:transparent" value="${escapeHtml(ing)}">
          <button class="icon-btn" data-action="del-ing" data-index="${i}">âœ–</button>
        `;
        ingredientsList.appendChild(li);

        const card = document.createElement("div");
        card.className = "card";
        card.innerHTML = `<strong>${escapeHtml(ing.split(':')[0] || ing)}</strong><div style="opacity:.9;margin-top:6px">${escapeHtml(ing.split(':').slice(1).join(':') || '')}</div>`;
        ingredientsCards.appendChild(card);
      });
      document.querySelectorAll(".ingredient-input").forEach(inp=>{
        inp.addEventListener("input", e=>{
          const idx = +e.target.dataset.index;
          state.ingredients[idx] = e.target.value;
          renderIngredients();
        });
      });
      document.querySelectorAll("[data-action='del-ing']").forEach(btn=>{
        btn.addEventListener("click", e=>{
          const idx = +e.target.dataset.index;
          state.ingredients.splice(idx,1);
          renderIngredients();
        });
      });
    }

    function renderReviews(){
      reviewsList.innerHTML = "";
      reviewsGrid.innerHTML = "";
      state.reviews.forEach((r,i)=>{
        // editor card
        const li = document.createElement("div");
        li.className = "list-item";
        li.style.flexDirection="column";
        li.innerHTML = `
          <div style="display:flex;gap:8px;width:100%;">
            <input type="text" data-index="${i}" class="rev-name" value="${escapeHtml(r.name)}" style="flex:1;border:0;background:transparent">
            <select data-index="${i}" class="rev-rating">
              <option ${r.rating==5?'selected':''} value="5">5â˜…</option>
              <option ${r.rating==4?'selected':''} value="4">4â˜…</option>
              <option ${r.rating==3?'selected':''} value="3">3â˜…</option>
              <option ${r.rating==2?'selected':''} value="2">2â˜…</option>
              <option ${r.rating==1?'selected':''} value="1">1â˜…</option>
            </select>
            <button class="icon-btn" data-action="del-review" data-index="${i}">âœ–</button>
          </div>
          <textarea data-index="${i}" class="rev-text" style="width:100%;border:0;background:transparent;margin-top:8px" rows="3">${escapeHtml(r.text)}</textarea>
          <div style="display:flex;gap:8px;margin-top:8px">
            <input type="url" data-index="${i}" class="rev-avatar" placeholder="avatar URL" value="${escapeHtml(r.avatar || '')}" style="flex:1;border:0;background:transparent">
            <input type="date" data-index="${i}" class="rev-date" value="${r.date || ''}">
          </div>
        `;
        reviewsList.appendChild(li);

        // preview review
        const rc = document.createElement("article");
        rc.className = "review-card";
        rc.innerHTML = `
          <div class="meta">
            <img src="${escapeAttr(r.avatar || 'https://i.pravatar.cc/150?img=1')}" class="avatar" onerror="this.src='https://i.pravatar.cc/150?img=1'">
            <div>
              <div style="font-weight:700">${escapeHtml(r.name)}</div>
              <div style="font-size:12px;color:var(--muted)">${r.date || ''}</div>
            </div>
          </div>
          <div style="margin-top:12px">${renderStars(r.rating)}<div style="margin-top:8px">${escapeHtml(r.text)}</div></div>
        `;
        reviewsGrid.appendChild(rc);
      });

      // events
      document.querySelectorAll(".rev-name").forEach(inp=> inp.addEventListener("input", e=>{
        const idx = +e.target.dataset.index; state.reviews[idx].name = e.target.value; renderReviews();
      }));
      document.querySelectorAll(".rev-text").forEach(inp=> inp.addEventListener("input", e=>{
        const idx = +e.target.dataset.index; state.reviews[idx].text = e.target.value; renderReviews();
      }));
      document.querySelectorAll(".rev-avatar").forEach(inp=> inp.addEventListener("input", e=>{
        const idx = +e.target.dataset.index; state.reviews[idx].avatar = e.target.value; renderReviews();
      }));
      document.querySelectorAll(".rev-rating").forEach(sel=> sel.addEventListener("change", e=>{
        const idx = +e.target.dataset.index; state.reviews[idx].rating = +e.target.value; renderReviews();
      }));
      document.querySelectorAll(".rev-date").forEach(d=> d.addEventListener("change", e=>{
        const idx = +e.target.dataset.index; state.reviews[idx].date = e.target.value; renderReviews();
      }));
      document.querySelectorAll("[data-action='del-review']").forEach(btn=> btn.addEventListener("click", e=>{
        const idx = +e.target.dataset.index; state.reviews.splice(idx,1); renderReviews();
      }));
    }

    function updateHeroBackground() {
      const backgroundType = state.backgroundType || DEFAULT.backgroundType;
      
      if (backgroundType === 'video') {
        // Video background
        const videoId = state.youtubeVideoId || DEFAULT.youtubeVideoId;
        videoContainer.innerHTML = '';
        
        if (videoId) {
          const iframe = document.createElement('iframe');
          iframe.src = `https://www.youtube.com/embed/${videoId}?autoplay=1&mute=1&loop=1&playlist=${videoId}&controls=1&showinfo=0&rel=0&modestbranding=1&disablekb=1&playsinline=1`;
          iframe.allow = 'autoplay; encrypted-media';
          iframe.allowFullscreen = true;
          iframe.frameBorder = '0';
          videoContainer.appendChild(iframe);
        }
        
        // Reset image background
        hero.style.backgroundImage = 'none';
      } else {
        // Image background
        const desktopUrl = state.bgDesktop || DEFAULT.bgDesktop;
        const mobileUrl = state.bgMobile || DEFAULT.bgMobile;
        
        // Set desktop background as default
        hero.style.backgroundImage = `url('${desktopUrl}')`;
        
        // Clear video container
        videoContainer.innerHTML = '';
        
        // Create a style element for mobile background
        let mobileStyle = document.getElementById('mobileBackgroundStyle');
        if (!mobileStyle) {
          mobileStyle = document.createElement('style');
          mobileStyle.id = 'mobileBackgroundStyle';
          document.head.appendChild(mobileStyle);
        }
        
        // Update mobile background media query
        mobileStyle.textContent = `
          @media (max-width: 768px) {
            .hero {
              background-image: url('${mobileUrl}') !important;
            }
          }
        `;
      }
    }

    function renderAll(){
      previewTitle.textContent = state.productName;
      previewSubtitle.textContent = state.subtitle;
      highlightName.textContent = state.productName;
      ctaBtn.href = state.buyLink;
      ctaBottom.href = state.buyLink;
      
      // Update CTA button text with two lines
      ctaBtn.innerHTML = `
        <span style="display:block; font-size: 14px; margin-bottom: 5px;">I WANT MY</span>
        <span style="display:block; font-size: 22px; font-weight: 800;">${state.productName.toUpperCase()} NOW</span>
      `;
      
      ctaBottom.innerHTML = `
        <span style="display:block; font-size: 14px; margin-bottom: 5px;">I WANT MY</span>
        <span style="display:block; font-size: 22px; font-weight: 800;">${state.productName.toUpperCase()} NOW</span>
      `;
      
      // Update hero background
      updateHeroBackground();
      
      footerYear.textContent = new Date().getFullYear();
      footerProduct.textContent = state.productName;
      privacyLink.href = state.privacyUrl || DEFAULT.privacyUrl;
      termsLink.href = state.termsUrl || DEFAULT.termsUrl;
      renderBenefits();
      renderIngredients();
      renderReviews();
      // persist automatically
      saveState(state);
    }

    /* ----- UI actions ----- */
    productNameInput.addEventListener("input", e=>{ state.productName = e.target.value || DEFAULT.productName; renderAll(); });
    subtitleInput.addEventListener("input", e=>{ state.subtitle = e.target.value; renderAll(); });
    buyLinkInput.addEventListener("input", e=>{ state.buyLink = e.target.value; renderAll(); });
    backgroundTypeInput.addEventListener("change", e=>{ 
      state.backgroundType = e.target.value; 
      toggleBackgroundFields();
      renderAll(); 
    });
    bgDesktopInput.addEventListener("input", e=>{ state.bgDesktop = e.target.value; renderAll(); });
    bgMobileInput.addEventListener("input", e=>{ state.bgMobile = e.target.value; renderAll(); });
    youtubeVideoIdInput.addEventListener("input", e=>{ state.youtubeVideoId = e.target.value; renderAll(); });
    privacyUrlInput.addEventListener("input", e=>{ state.privacyUrl = e.target.value; renderAll(); });
    termsUrlInput.addEventListener("input", e=>{ state.termsUrl = e.target.value; renderAll(); });

    addBenefitBtn.addEventListener("click", ()=>{
      const v = newBenefitInput.value.trim();
      if(!v) return;
      state.benefits.push(v);
      newBenefitInput.value="";
      renderAll();
      showStatus("BenefÃ­cio adicionado com sucesso!");
    });

    addIngredientBtn.addEventListener("click", ()=>{
      const v = newIngredientInput.value.trim();
      if(!v) return;
      state.ingredients.push(v);
      newIngredientInput.value="";
      renderAll();
      showStatus("Ingrediente adicionado com sucesso!");
    });

    addReviewBtn.addEventListener("click", ()=>{
      state.reviews.push({name:"New Reviewer", text:"Review text...", rating:5, date:new Date().toISOString().slice(0,10), avatar:""});
      renderAll();
      // scroll editor to bottom
      reviewsList.lastChild?.scrollIntoView({behavior:"smooth", block:"center"});
      showStatus("Review adicionado com sucesso!");
    });

    saveBtn.addEventListener("click", ()=>{ 
      saveState(state); 
      showStatus("AlteraÃ§Ãµes salvas com sucesso!");
    });

    resetBtn.addEventListener("click", ()=>{
      if(!confirm("Resetar tudo para os valores padrÃ£o?")) return;
      state = {...DEFAULT};
      saveState(state);
      populateEditorFromState();
      renderAll();
      showStatus("ConfiguraÃ§Ãµes resetadas para padrÃ£o!");
    });

    // Export HTML: create standalone file using current state
    exportBtn.addEventListener("click", ()=>{
      try {
        const html = generateExportHtml(state);
        const blob = new Blob([html], {type:"text/html;charset=utf-8"});
        const url = URL.createObjectURL(blob);
        const a = document.createElement("a");
        a.href = url;
        a.download = `${(state.productName||'presell').toLowerCase().replace(/\s+/g,'_')}_presell.html`;
        document.body.appendChild(a);
        a.click();
        a.remove();
        URL.revokeObjectURL(url);
        showStatus("HTML exportado com sucesso!");
      } catch (error) {
        console.error("Export error:", error);
        showStatus("Erro ao exportar HTML", false);
      }
    });

    /* Utility */
    function renderStars(n){
      let s = "";
      for(let i=0;i<n;i++) s += "â˜…";
      for(let i=n;i<5;i++) s += "â˜†";
      return `<span style="color:#ffc107;font-size:16px">${s}</span>`;
    }

    function escapeHtml(text){
      if(text==null) return "";
      return String(text).replace(/[&<>"']/g, function(m){ return {'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m];});
    }
    function escapeAttr(t){ return escapeHtml(t) }

    /* initial render */
    populateEditorFromState();
    renderAll();

    /* enable mobile editor toggle */
    const editor = document.getElementById("editor");
    const toggle = document.getElementById("toggleEditor");
    function checkSmall(){
      if(window.innerWidth<=900){ 
        toggle.style.display="inline-block"; 
        editor.classList.remove('open'); 
      } else { 
        toggle.style.display="none"; 
        editor.classList.remove('open'); 
      }
    }
    checkSmall();
    window.addEventListener("resize", checkSmall);
    toggle.addEventListener("click", ()=> {
      editor.classList.toggle('open');
      toggle.textContent = editor.classList.contains('open') ? 'Fechar' : 'Editor';
    });

    /* ---------- Export generator: produce a standalone presell HTML ---------- */
    function generateExportHtml(st){
      // simple standalone HTML using inlined styles and content
      const safe = (s)=> escapeHtml(s||"");
      const benefitsHtml = (st.benefits || []).map(b=>`<div class="card">${escapeHtml(b)}</div>`).join("\n");
      const ingredientsHtml = (st.ingredients || []).map(ing=>{
        const title = escapeHtml((ing.split(':')[0]||ing).trim());
        const desc = escapeHtml(ing.split(':').slice(1).join(':').trim());
        return `<div class="card"><strong>${title}</strong><div style="margin-top:6px">${desc}</div></div>`;
      }).join("\n");
      const reviewsHtml = (st.reviews || []).map(r=>{
        return `<article class="review-card">
          <div class="meta">
            <img src="${escapeAttr(r.avatar || 'https://i.pravatar.cc/150?img=1')}" class="avatar" onerror="this.src='https://i.pravatar.cc/150?img=1'">
            <div>
              <div style="font-weight:700">${escapeHtml(r.name)}</div>
              <div style="font-size:12px;color:#7a7a7a">${escapeHtml(r.date || '')}</div>
            </div>
          </div>
          <div style="margin-top:12px">${renderStars(r.rating)}<div style="margin-top:8px">${escapeHtml(r.text)}</div></div>
        </article>`;
      }).join("\n");

      const backgroundType = st.backgroundType || DEFAULT.backgroundType;
      let heroBackgroundHtml = '';
      
      if (backgroundType === 'video') {
        const videoId = st.youtubeVideoId || DEFAULT.youtubeVideoId;
        heroBackgroundHtml = `
          <div class="video-container">
            <iframe src="https://www.youtube.com/embed/${videoId}?autoplay=1&mute=1&loop=1&playlist=${videoId}&controls=1&showinfo=0&rel=0&modestbranding=1&disablekb=1&playsinline=1" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>
          </div>
        `;
      } else {
        const desktopUrl = st.bgDesktop || DEFAULT.bgDesktop;
        const mobileUrl = st.bgMobile || DEFAULT.bgMobile;
        heroBackgroundHtml = `
          <style>
            .hero {
              background-image: url('${desktopUrl}');
            }
            @media (max-width: 768px) {
              .hero {
                background-image: url('${mobileUrl}') !important;
              }
            }
          </style>
        `;
      }
      
      // exported HTML: keep it simple and include the background
      const exported = `<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>${safe(st.productName)}</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --accent: #f59e0b;
      --accent-dark: #fbbf24;
      --primary: #0a2342;
      --muted: #7a7a7a;
      --card-bg: #fff;
      --bg: #f8fafc;
    }
    body{font-family:'Poppins',sans-serif;margin:0;background:var(--bg);color:#1e293b}
    header{background:linear-gradient(135deg,var(--primary),#1e3a8a);color:#fff;text-align:center;padding:60px 20px;border-bottom:6px solid var(--accent-dark)}
    header h1{font-size:2.4em;margin:0}
    header p{margin-top:6px}
    .hero{height:70vh;position:relative;display:flex;align-items:center;justify-content:center;background-size:cover;background-position:center;overflow:hidden}
    .video-container{position:absolute;top:0;left:0;width:100%;height:100%;overflow:hidden}
    .video-container iframe{width:100%;height:100%;object-fit:cover}
    .hero::before{content:'';position:absolute;top:0;left:0;width:100%;height:100%;background:rgba(10,35,66,0.3);z-index:1}
    .hero > *{position:relative;z-index:2}
    .cta{background:linear-gradient(90deg,var(--accent-dark),var(--accent));color:#072033;padding:15px 30px;border-radius:50px;text-decoration:none;font-weight:700;display:inline-block;box-shadow:0 8px 24px rgba(251,191,36,0.25);transition:all 0.3s;font-size:18px;text-align:center;line-height:1.4}
    .cta:hover{transform:translateY(-3px);box-shadow:0 12px 28px rgba(251,191,36,0.35)}
    .content{max-width:1100px;margin:32px auto;padding:0 20px}
    .cards{display:grid;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));gap:18px;margin-top:16px}
    .card{background:#fff;padding:18px;border-radius:12px;border:1px solid #eef5ff;box-shadow:0 6px 18px rgba(2,6,23,0.03);transition:transform 0.2s}
    .card:hover{transform:translateY(-5px)}
    .testimonials{padding:40px 0;margin-top:26px}
    .reviews-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));gap:18px}
    .review-card{background:#fff;border-radius:12px;padding:16px;box-shadow:0 8px 20px rgba(2,6,23,0.04);transition:transform 0.2s}
    .review-card:hover{transform:translateY(-5px)}
    .avatar{width:56px;height:56px;border-radius:50%;object-fit:cover;border:2px solid #f2f2f2}
    footer{background:var(--primary);color:#fff;padding:24px;text-align:center;border-top:4px solid var(--accent);margin-top:28px}
    footer a{color:#dbeafe;text-decoration:underline}
    
    /* Mobile styles */
    @media(max-width:768px){ 
      .hero {
        height: auto;
        min-height: 80vh;
        flex-direction: column;
        padding: 20px 0;
      }
      
      .video-container {
        position: relative;
        height: 50vh;
        width: 100%;
        flex-shrink: 0;
      }
      
      .hero::before {
        display: none;
      }
      
      .video-container::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(10, 35, 66, 0.3);
        z-index: 1;
      }
      
      .cta {
        margin-top: 20px;
        font-size: 16px;
        padding: 12px 24px;
        width: 90%;
        max-width: 300px;
      }
    }
  </style>
  ${backgroundType === 'image' ? heroBackgroundHtml : ''}
</head>
<body>
  <header>
    <h1>${safe(st.productName)} ðŸ’ª</h1>
    <p>${safe(st.subtitle || '')}</p>
  </header>
  <div class="hero">
    ${backgroundType === 'video' ? heroBackgroundHtml : ''}
    <a class="cta" href="${escapeAttr(st.buyLink || '#')}">
      <span style="display:block; font-size: 14px; margin-bottom: 5px;">I WANT MY</span>
      <span style="display:block; font-size: 22px; font-weight: 800;">${safe(st.productName).toUpperCase()} NOW</span>
    </a>
  </div>
  <div class="content">
    <section>
      <h2>ðŸŒ¿ Rediscover Your Natural Vitality</h2>
      <p><strong style="color:var(--accent)">${safe(st.productName)}</strong> is an all-natural formula designed to support her and enhance sexual drive. Made in the USA from a proprietary powerful natural ingredients, it promotes healthy blood flow supports overall vitality, improves energy, sleep quality, skin and inflammatory response.</p>
    </section>

    <section>
      <h2>ðŸ’¥ Exclusive Benefits</h2>
      <div class="cards">${benefitsHtml}</div>
    </section>

    <section>
      <h2>ðŸŒ± Selected Natural Ingredients</h2>
      <div class="cards">${ingredientsHtml}</div>
    </section>

    <div style="text-align:center;margin:32px 0">
      <a class="cta" href="${escapeAttr(st.buyLink || '#')}">
        <span style="display:block; font-size: 14px; margin-bottom: 5px;">I WANT MY</span>
        <span style="display:block; font-size: 22px; font-weight: 800;">${safe(st.productName).toUpperCase()} NOW</span>
      </a>
    </div>

    <section class="testimonials">
      <h2>What customers are saying</h2>
      <div class="reviews-grid">${reviewsHtml}</div>
      <p style="font-size:12px;color:var(--muted);margin-top:8px">*Results may vary from person to person.</p>
    </section>
  </div>

  <footer>
    <p>Â© ${new Date().getFullYear()} ${safe(st.productName)} â€” <a href="${escapeAttr(st.privacyUrl||'privacy.html')}">Privacy Policy</a> | <a href="${escapeAttr(st.termsUrl||'terms.html')}">Terms</a></p>
  </footer>
</body>
</html>
`;
      return exported;
    }

  </script>
</body>
</html>
